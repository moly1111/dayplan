# Plan - 长期计划管理

Plan 是一个专注于长期计划管理的界面，支持普通计划和基于艾宾浩斯遗忘曲线的复习计划。

## 功能特性

### 1. 月份大表视图
- 显示当前月份的完整日历
- 支持月份导航（上一月/下一月）
- 日期单元格显示计划标记点
- 今天日期高亮显示

### 2. 计划类型

#### 普通计划
- 单次计划，只在选定日期添加
- 适用于一次性任务或事件

#### 遗忘曲线计划
- 基于艾宾浩斯遗忘曲线自动生成复习日期
- 间隔天数：1, 2, 4, 7, 15, 30 天
- 创建后自动在所有相关日期添加计划
- 适用于需要定期复习的学习内容

### 3. 计划管理
- **添加计划**：右键点击日期单元格，选择"添加普通计划"或"添加遗忘曲线计划"
- **查看计划**：点击日期单元格查看该日期的所有计划
- **完成计划**：在计划列表中点击"完成"按钮
- **编辑计划**：
  - 普通计划：直接编辑当前日期
  - 遗忘曲线计划：可选择"仅当前日期"或"所有相关日期"
- **删除计划**：
  - 普通计划：直接删除
  - 遗忘曲线计划：可选择"仅删除当前日期"或"删除所有相关日期"

### 4. 视觉标记
- **蓝色标记**：普通计划（未完成）
- **紫色标记**：遗忘曲线计划（未完成）
- **绿色标记**：已完成计划

### 5. 主题支持
- 支持浅色/深色主题切换
- 在设置面板中切换主题
- 主题设置独立存储

### 6. 数据管理
- **独立存储**：使用 `planApp` key 在 localStorage 中独立存储
- **数据导出**：支持导出为 JSON 文件
- **数据导入**：支持从 JSON 文件导入

## 使用方法

### 添加计划
1. 右键点击目标日期单元格
2. 选择"添加普通计划"或"添加遗忘曲线计划"
3. 输入计划内容
4. 点击"确认"按钮

### 查看和管理计划
1. 点击日期单元格打开计划列表
2. 在列表中完成、编辑或删除计划

### 切换主题
1. 点击右上角设置按钮
2. 在"外观"部分选择主题
3. 主题立即生效

## 技术实现

### 文件结构
```
plan/
├── index.html              # 主页面
├── css/
│   └── plan.css           # Plan 专用样式
├── js/
│   ├── plan-storage.js    # 数据存储管理
│   ├── plan-calendar.js   # 月份大表渲染
│   ├── plan-context-menu.js  # 右键菜单
│   ├── plan-dialog.js     # 添加/编辑对话框
│   └── plan-main.js       # 主逻辑
└── README.md              # 说明文档
```

### 数据模型
```javascript
{
  plans: {
    "2025-01-01": [
      {
        id: 1,
        text: "学习新技能",
        type: "normal" | "ebbinghaus",
        createdAt: "2025-01-01",
        completedAt: null,
        // 仅遗忘曲线计划有：
        ebbinghausDates: ["2025-01-01", "2025-01-02", ...],
        ebbinghausIndex: 0,
        ebbinghausRootId: 1234567890
      }
    ]
  },
  settings: {
    theme: "light" | "dark"
  }
}
```

## 未来计划

- [ ] 与 xkm 版本的任务系统集成
- [ ] 完成计划后自动添加到对应日期的任务列表
- [ ] 计划统计功能（本月计划数、完成率等）
- [ ] 计划搜索功能
- [ ] 批量操作功能

## 注意事项

- Plan 使用独立的存储空间（`planApp`），与主应用（`todoApp`）分离
- 遗忘曲线计划的删除和编辑操作会影响所有相关日期，请谨慎操作
- 数据存储在浏览器本地，清除浏览器数据会导致数据丢失，建议定期备份

